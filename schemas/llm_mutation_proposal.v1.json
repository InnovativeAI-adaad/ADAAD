{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://adaad.dev/schemas/llm_mutation_proposal.v1.json",
  "title": "LLM Mutation Proposal v1",
  "type": "object",
  "required": [
    "agent_id",
    "generation_ts",
    "intent",
    "ops",
    "targets",
    "signature",
    "nonce"
  ],
  "additionalProperties": false,
  "properties": {
    "agent_id": {"type": "string", "minLength": 1},
    "generation_ts": {"type": "string"},
    "intent": {"type": "string"},
    "ops": {
      "type": "array",
      "items": {"type": "object", "additionalProperties": true}
    },
    "targets": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["agent_id", "path", "target_type", "ops"],
        "additionalProperties": false,
        "properties": {
          "agent_id": {"type": "string", "minLength": 1},
          "path": {"type": "string", "minLength": 1},
          "target_type": {"type": "string", "minLength": 1},
          "ops": {
            "type": "array",
            "items": {"type": "object", "additionalProperties": true}
          },
          "hash_preimage": {"type": "string"}
        }
      }
    },
    "signature": {"type": "string"},
    "nonce": {"type": "string"},
    "epoch_id": {"type": "string"},
    "bundle_id": {"type": "string"},
    "random_seed": {"type": "integer"},
    "capability_scopes": {
      "type": "array",
      "items": {"type": "string"}
    },
    "authority_level": {"type": "string"}
  }
}
